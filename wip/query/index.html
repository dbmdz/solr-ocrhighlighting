
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../alternatives/">
      
      
        <link rel="next" href="../example/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.3.2">
    
    
      
        <title>Querying - Solr OCR Highlighting Plugin</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.30068a00.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#enabling-highlighting-for-ocr-fields" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Solr OCR Highlighting Plugin" class="md-header__button md-logo" aria-label="Solr OCR Highlighting Plugin" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Solr OCR Highlighting Plugin
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Querying
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/dbmdz/solr-ocrhighlighting/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Solr OCR Highlighting Plugin" class="md-nav__button md-logo" aria-label="Solr OCR Highlighting Plugin" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Solr OCR Highlighting Plugin
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/dbmdz/solr-ocrhighlighting/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../indexing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Indexing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../alternatives/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Indexing Alternative Terms
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Querying
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Querying
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enabling-highlighting-for-ocr-fields" class="md-nav__link">
    Enabling Highlighting for OCR Fields
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#response-format" class="md-nav__link">
    Response Format
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-of-snippet-regions" class="md-nav__link">
    Generation of Snippet Regions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#available-highlighting-parameters" class="md-nav__link">
    Available highlighting parameters
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example Setup
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../performance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Performance Tuning
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../formats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Supported Formats
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../changes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Change Log
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enabling-highlighting-for-ocr-fields" class="md-nav__link">
    Enabling Highlighting for OCR Fields
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#response-format" class="md-nav__link">
    Response Format
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-of-snippet-regions" class="md-nav__link">
    Generation of Snippet Regions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#available-highlighting-parameters" class="md-nav__link">
    Available highlighting parameters
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Querying</h1>

<h2 id="enabling-highlighting-for-ocr-fields">Enabling Highlighting for OCR Fields</h2>
<p>To enable highlighting, make sure you set <code>hl=true</code> in you query. Additionally, you need to pass the OCR fields that
you want to have highlighted in the <code>hl.ocr.fl</code> parameter.</p>
<div class="admonition caution">
<p class="admonition-title">Setting highlighting fields for regular highlighting</p>
<p>In some circumstances you need to set the <code>hl.fl</code> parameter for the list of fields to use for regular
highlighting explicitly. It suffices to set this to an empty string (i.e. <code>hl.fl=</code>).
You will know you're affected by this problem if highlighting fails, and you see an error message
<code>undefined field null</code> in your Solr logs. This is probably due to a bug in Solr itself that has
yet to be investigated. Setting <code>hl.fl</code> explicitly avoids the problem.</p>
</div>
<h2 id="response-format">Response Format</h2>
<p>With OCR highlighting enabled, your Solr response will now include a new item <code>ocrHighlighting</code>, mapping all
highlighted OCR fields to their highlighting snippets:</p>
<p><code>GET</code> <a href="https://ocrhl.jbaiter.de/solr/ocr/select?q=ocr_text:%22Mason%20Dixon%22~10&amp;hl=true&amp;hl.ocr.fl=ocr_text"><code>https://ocrhl.jbaiter.de/solr/ocr/select?q=ocr_text:%22Mason%20Dixon%22~10&amp;hl=true&amp;hl.ocr.fl=ocr_text</code></a>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="nt">&quot;responseHeader&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="nt">&quot;QTime&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">111</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">  </span><span class="nt">&quot;response&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="nt">&quot;numFound&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="nt">&quot;start&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">    </span><span class="nt">&quot;docs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;doc_id&quot;</span><span class="w"> </span><span class="p">}]</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">  </span><span class="p">},</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">  </span><span class="nt">&quot;ocrHighlighting&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">    </span><span class="nt">&quot;ident&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">      </span><span class="nt">&quot;ocr_text&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">        </span><span class="nt">&quot;numTotal&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">        </span><span class="nt">&quot;snippets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="cm">/* see below */</span><span class="p">]</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">      </span><span class="p">}</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">    </span><span class="p">}</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">  </span><span class="p">}</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="p">}</span>
</code></pre></div></p>
<p>The <code>numTotal</code> key will specify how many highlighting snippets were found in the document for the query.
How many of these are actually contained in the response under the <code>snippets</code> key depends on the value
for the <code>hl.snippets</code> parameter, which defaults to <code>1</code>.</p>
<p>The objects contained under the <code>snippets</code> key are structured like this:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">{</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span><span class="nt">&quot;text&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;to those parts, subject to unreasonable claims from the proprietor &quot;</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">          </span><span class="s2">&quot;of Maryland, until the year 17C2, when the whole controversy was &quot;</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">          </span><span class="s2">&quot;settled by Charles &lt;em&gt;Mason and Jeremiah Dixon&lt;/em&gt;, upon their &quot;</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">          </span><span class="s2">&quot;return from an observation of the transit of Venus, at the Cape of &quot;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">          </span><span class="s2">&quot;Good Hope, where they&quot;</span><span class="p">,</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">  </span><span class="nt">&quot;score&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">5555104.5</span><span class="p">,</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">  </span><span class="nt">&quot;pages&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;page_380&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;width&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1436</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;height&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2427</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">  </span><span class="nt">&quot;regions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;ulx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">196</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;uly&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1703</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;lrx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1232</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;lry&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1968</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;pageIdx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="w">  </span><span class="p">],</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="w">  </span><span class="nt">&quot;highlights&quot;</span><span class="p">:[</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="w">    </span><span class="p">[{</span><span class="w"> </span><span class="nt">&quot;text&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mason and Jeremiah&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;ulx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">675</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;uly&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">110</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;lrx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1036</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;lry&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">145</span><span class="p">,</span>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="w">       </span><span class="nt">&quot;parentRegionIdx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="w">     </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;text&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Dixon,&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;ulx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;uly&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">167</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;lrx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">119</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;lry&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">204</span><span class="p">,</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="w">       </span><span class="nt">&quot;parentRegionIdx&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}]</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="w">  </span><span class="p">]</span>
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="p">}</span>
</code></pre></div></p>
<ul>
<li><code>text</code> contains the plain text of the region containing one or more matches. The matches themselves are wrapped
  in <code>&lt;em&gt;</code> tags (this can be customized with the <code>hl.tag.pre</code> and <code>hl.tag.post</code> parameters).</li>
<li><code>score</code> contains the numerical score (relative to the whole document) that Solr assigned to the snippet</li>
<li><code>pages</code> contains a list of pages the snippet appears on along with their pixel dimensions. This can be useful
  for rendering highlights, e.g. if the highlighting target image is scaled down from the source image.</li>
<li><code>regions</code> contains a list of regions that the snippet is located on. Usually this will contain only one item,
  but in cases where a phrase spans multiple pages, it will contain a region for every page involved in the match.
  The object includes coordinates for all four corners it is defined by, as well as the identifier of the <code>page</code> the
  region is located on.</li>
<li><code>highlights</code> contains a list of regions that contain the actual matches for the query as well as the <code>text</code> that
  matched the query and the page the match occurred on. <strong>Note that the coordinates are relative to the containing
  region, not the page</strong> (this can be changed with the <code>hl.ocr.absoluteHighlights</code> parameter). To find the
  corresponding region for a match, use the <code>regionIdx</code> value, which refers to the index in the <code>regions</code> array that
  the surrounding region is located at.</li>
</ul>
<h2 id="generation-of-snippet-regions">Generation of Snippet Regions</h2>
<p>To determine how to build regions from a set of matches, the plugin takes into account the structure of the OCR
document surrounding each match. Consider the following page from a document, with two matches on two adjacent
lines.</p>
<p><img alt="" src="../img/query_params.png" /></p>
<p>First, the plugin will determine the <strong>context</strong> of each match, starting with the first match. For this, it searches
for a fixed number of <strong>context blocks</strong> before and after the block it is in. The type of context block is configured
with the <code>hl.ocr.contextBlock</code> parameter and it defaults to <code>line</code> (for a list of all possible block types, refer
to the full list of parameters). The number of context blocks to use for the
snippet context is set with the <code>hl.ocr.contextSize</code> parameter and defaults to <code>2</code>. So for our first match, the context
will be the two lines above and below the line of the match.</p>
<p>It then proceeds to the next match, which happens to be located on the next line block. If the new match is part of
the previous match's context, it will be <strong>merged</strong> into the previous snippet and the snippet will be updated.
In the example, the snippet would grow by two lines (since the context is two line blocks below the last match).</p>
<p>However, the plugin will not expand the context beyond the limits of certain blocks. In our example, we decided that
we don't want contexts to cross <strong>block</strong> elements. This <strong>limit block</strong> can be configured with the <code>hl.ocr.limitBlock</code>
parameter and defaults to <code>block</code> (which is format-dependent, but usually refers to a group of one or more paragraphs
). If, during context building, a block is encountered that is of this type (or an even higher level), the context
building will be stopped. In the example, the context of the snippet is only one line below the last match, since
this is the last line in the containing <code>block</code>. <strong>Note that you will still occasionally get snippets that span multiple
blocks</strong>, in the case when you searched for a phrase and the phrase match crosses multiple blocks.</p>
<h2 id="available-highlighting-parameters">Available highlighting parameters</h2>
<p>Since the OCR highlighter builds upon Solr's <code>UnifiedHighlighter</code>, you can use most of the
<a href="https://lucene.apache.org/solr/guide/8_1/highlighting.html#common-highlighter-parameters">Common Highlighter parameters</a>
and the
<a href="https://lucene.apache.org/solr/guide/8_1/highlighting.html#the-unified-highlighter">Unified Highlighter parameters</a>.</p>
<p>Of special interest for purposes of OCR highlighting are these:</p>
<dl>
<dt><code>hl</code></dt>
<dd>Enable highlighting with <code>on</code>. <strong>Required</strong> if you want highlighting of any kind. Defaults to <code>off</code>.</dd>
<dt><code>hl.snippets</code></dt>
<dd>Number of snippets per document to include in the response, defaults to <code>1</code>.
Use <code>f.&lt;ocr_field&gt;.hl.snippets</code> if you want a different number of snippets between regular highlighting
and OCR highlighting.</dd>
<dt><code>hl.tag.pre</code>/<code>hl.tag.post</code></dt>
<dd>Strings to wrap matches in the plaintext version of the snippet with, defaults to <code>&lt;em&gt;</code>/<code>&lt;/em&gt;</code>.
Use <code>hl.ocr.tag.pre</code> / <code>hl.ocr.tag.post</code> if you want different tags for regular highlighting
and OCR highlighting.</dd>
<dt><code>hl.weightMatches</code></dt>
<dd>Uses a new and improved highlighting algorithm that is much more precise than the old approach.
For example, with this set to <code>true</code>, results for a phrase query <code>"foo bar baz"</code> will actually be
highlighted as <code>&lt;em&gt;foo bar baz&lt;/em&gt;</code> and not as <code>&lt;em&gt;foo&lt;/em&gt; &lt;em&gt;bar&lt;/em&gt; &lt;em&gt;baz&lt;/em&gt;</code>. Defaults to
<code>off</code> in Solr versions &lt; 8.0, <code>on</code> for all versions &gt; 8.0.
Use <code>f.&lt;ocr_field&gt;.hl.weightMatches</code> if you want to set this differently from regular highlighting.</dd>
<dt><code>hl.qparser</code>:</dt>
<dd>Allows you to customize the query parser used for analyzing the query for highlighting.
See the <a href="https://solr.apache.org/guide/solr/latest/query-guide/highlighting.html"><code>hl.qparser</code> documentation in the Solr guide for more details</a>.
Use <code>hl.ocr.qparser</code> if you want to set this differently between OCR highlighting and regular highlighting.</dd>
<dt><code>hl.q</code>:</dt>
<dd>Allows you to customize the query used for highlighting the documents in the result set.
See the <a href="https://solr.apache.org/guide/solr/latest/query-guide/highlighting.html"><code>hl.q</code> documentation in the Solr guide for more details</a>.
Use <code>hl.ocr.q</code> if you want to set this differently between OCR highlighting and regular highlighting.</dd>
</dl>
<p>Additionally, the plugin allows you to customize various OCR-specific parameters:</p>
<dl>
<dt><code>hl.ocr.fl</code></dt>
<dd>Fields to enable OCR highlighting for. This is <strong>required</strong> if you want to have OCR highlighting.</dd>
<dt><code>hl.ocr.contextBlock</code></dt>
<dd>Select which block type should be considered for determining the context. Valid values are
<code>word</code>, <code>line</code>, <code>paragraph</code>, <code>block</code> or <code>page</code> and defaults to <code>line</code>.</dd>
<dt><code>hl.ocr.contextSize</code></dt>
<dd>Set the number of blocks above and below the matching block to be included in the passage.
Defaults to <code>2</code>.</dd>
<dt><code>hl.ocr.limitBlock</code></dt>
<dd>Set the block type that the passage context may not exceed. Valid values are <code>none</code> <code>word</code>, <code>line</code>,
<code>paragraph</code>, <code>block</code> or <code>page</code>. This value defaults to <code>block</code>.</dd>
<dt><code>hl.ocr.alignSpans</code></dt>
<dd>Ensure that the spans in the highlighted text match the text of the highlighted image parts exactly.
By default (<code>false</code>), text spans will be more precise than image spans, since they can be defined at the
character-level, while image spans can only be as precise as the word boundaries in the OCR.</dd>
<dt><code>hl.ocr.pageId</code>:</dt>
<dd>Only show passages from the page with this identifier. Useful in combination with a <code>fq</code> for a specific document
if you want to implement a "Search on this page" feature (e.g. for the
<a href="https://iiif.io/api/search/1.0/">IIIF Content Search API</a>).</dd>
<dt><code>hl.ocr.absoluteHighlights</code>:</dt>
<dd>When <code>on</code>, return the coordinates of highlighted regions as absolute coordinates, i.e. relative to the containing page,
not the containing snippet region. Defaults to <code>off</code>.</dd>
<dt><code>hl.ocr.maxPassages</code>:</dt>
<dd>Only score and rank at most this many passages to get the final list of snippets. This parameter can be used to tweak
the performance. If you notice that highlighting takes a long time, you might consider lowering this value.
The default is <code>100</code>. The practical result is that only the first <code>n</code> matches in a document will be considered
for highlighting, i.e. if a more relevant passage occurs at the end of the document, it is more likely to not be
considered if the total number of matches in the document exceeds this number.</dd>
<dt><code>hl.ocr.timeAllowed</code>:</dt>
<dd>Due to the fact that generating highlighting snippets from disk can take a very long time, depending on the
number of documents and snippets, you can limit the time OCR highlighting should take. The parameter takes the
maximum allowed time in <strong>milliseconds</strong>. If the timeout is exceeded during highlighting, the document currently
being highlighted and any other remaining documents will be skipped. The highlighting response will then only
include snippets from documents that were highlighted before the timeout. The presence of partial results will be
indicated by the <code>partialOcrHighlights</code> key in the <code>responseHeader</code>.</dd>
<dt><code>hl.ocr.trackPages</code>:</dt>
<dd>When <code>off</code> (defaults to <code>on</code>), you will not get information the containing page of a given snippet.
This can improve highlighting performance, since less of the input file needs to be read and should
be disabled when you index your documents at the page-level, i.e. when the identify of the page is
encoded elsewhere in the document.</dd>
<dt><code>hl.ocr.scorePassages</code>:</dt>
<dd>When <code>off</code> (defaults to <code>on</code>), the snippets are returned in order of their occurrence in the document. Otherwise,
it will follow Solr's default strategy for scoring highlighting snippets, which treats each candidate snippet as
a 'mini-document' that is scored using TF-IDF/BM25, treating the parent document as the corpus. This results in
a relevance score in relation to the parent document, i.e. the first snippet should be the most relevant snippet
in the document.</dd>
</dl>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>